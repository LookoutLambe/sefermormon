@import url('https://fonts.googleapis.com/css2?family=David+Libre:wght@400;500;700&display=swap');

:root {
  --parchment: #f5f0e8;
  --ink: #1a1410;
  --ink-soft: #3d3428;
  --ink-faint: #6b5f4f;
  --gold: #8b7340;
  --gold-light: #b89b5e;
  --gold-bright: #d4af37;
  --border: #d4c9b4;
  --sidebar-bg: #1a1410;
  --sidebar-text: #d4c9b4;
  --sidebar-hover: #2a2218;
  --sidebar-active: #3a3020;
  --verse-hover: rgba(139,115,64,0.06);
  --shadow: rgba(26,20,16,0.12);
  --font-body: 'David Libre', serif;
  --font-display: 'David Libre', serif;
  --fs-base: 1.25rem;
  --content-max: 740px;
  --sidebar-w: 300px;
  --header-h: 56px;
}

[data-theme="dark"] {
  --parchment: #1a1814;
  --ink: #ddd5c4;
  --ink-soft: #bbb3a2;
  --ink-faint: #8a8274;
  --gold: #c9a84c;
  --gold-light: #d4b85e;
  --gold-bright: #e8c44a;
  --border: #2e2a22;
  --sidebar-bg: #0e0d0a;
  --sidebar-text: #a09882;
  --sidebar-hover: #1e1c16;
  --sidebar-active: #2a2720;
  --verse-hover: rgba(201,168,76,0.06);
  --shadow: rgba(0,0,0,0.3);
}

* { margin:0; padding:0; box-sizing:border-box; }
html { font-size:16px; scroll-behavior:smooth; }

body {
  font-family: var(--font-body);
  background: var(--parchment);
  color: var(--ink);
  line-height: 1.95;
  -webkit-font-smoothing: antialiased;
  overflow-x: hidden;
}

/* ===== HEADER ===== */
.app-header {
  position:fixed; top:0; left:0; right:0;
  height: var(--header-h);
  background: var(--sidebar-bg);
  color: var(--sidebar-text);
  display:flex; align-items:center; justify-content:space-between;
  padding: 0 20px; z-index:1000;
  border-bottom: 1px solid rgba(212,175,55,0.15);
}

.header-right, .header-left { display:flex; align-items:center; gap:6px; }

.header-title {
  font-family: var(--font-display);
  font-size:1.1rem; font-weight:700;
  color: var(--gold-bright); letter-spacing:0.02em;
}

.header-subtitle {
  font-size:0.75rem; color:var(--sidebar-text);
  opacity:0.6; margin-right:12px;
}

.btn-icon {
  background:none;
  border:1px solid rgba(212,175,55,0.2);
  color:var(--sidebar-text);
  width:36px; height:36px; border-radius:8px;
  display:flex; align-items:center; justify-content:center;
  cursor:pointer; font-size:1rem; transition:all 0.2s;
}
.btn-icon:hover { background:rgba(212,175,55,0.1); border-color:var(--gold); color:var(--gold-bright); }

/* ===== LANGUAGE TOGGLE ===== */
.lang-toggle {
  display:flex; border:1px solid rgba(212,175,55,0.25); border-radius:8px; overflow:hidden;
}
.lang-btn {
  background:none; border:none; color:var(--sidebar-text);
  padding:6px 10px; cursor:pointer; font-size:0.75rem;
  font-family:var(--font-body); transition:all 0.2s;
  border-right:1px solid rgba(212,175,55,0.15);
}
.lang-btn:last-child { border-right:none; }
.lang-btn:hover { background:rgba(212,175,55,0.1); }
.lang-btn.active { background:var(--gold); color:var(--sidebar-bg); font-weight:700; }

.font-controls {
  display:flex; align-items:center; gap:2px;
  margin-left:6px; padding-left:6px;
  border-left:1px solid rgba(212,175,55,0.15);
}
.font-controls .btn-icon { width:32px; height:32px; font-size:0.85rem; }

/* ===== SIDEBAR ===== */
.sidebar {
  position:fixed; top:var(--header-h); right:0;
  width:var(--sidebar-w); height:calc(100vh - var(--header-h));
  background:var(--sidebar-bg);
  overflow-y:auto; z-index:900;
  transform:translateX(100%);
  transition:transform 0.3s cubic-bezier(0.4,0,0.2,1);
  border-left:1px solid rgba(212,175,55,0.1);
}
.sidebar.open { transform:translateX(0); }
.sidebar::-webkit-scrollbar { width:4px; }
.sidebar::-webkit-scrollbar-thumb { background:rgba(212,175,55,0.2); border-radius:4px; }

.nav-section { padding:16px; border-bottom:1px solid rgba(212,175,55,0.08); }
.nav-section-title { font-size:0.7rem; letter-spacing:0.1em; color:var(--gold); font-weight:700; margin-bottom:8px; }

.nav-book {
  cursor:pointer; padding:6px 10px; border-radius:6px;
  font-size:0.9rem; color:var(--sidebar-text); transition:all 0.15s;
  display:flex; align-items:center; justify-content:space-between;
}
.nav-book:hover { background:var(--sidebar-hover); }
.nav-book.active { background:var(--sidebar-active); color:var(--gold-bright); }
.nav-book .arrow { font-size:0.6rem; transition:transform 0.2s; opacity:0.4; }
.nav-book.expanded .arrow { transform:rotate(90deg); }

.nav-chapters { display:none; padding:4px 0 4px 12px; flex-wrap:wrap; gap:2px; }
.nav-chapters.open { display:flex; }

.nav-ch {
  cursor:pointer; width:36px; height:32px;
  display:flex; align-items:center; justify-content:center;
  border-radius:6px; font-size:0.8rem;
  color:var(--sidebar-text); transition:all 0.15s;
}
.nav-ch:hover { background:var(--sidebar-hover); color:var(--gold-light); }
.nav-ch.active { background:var(--gold); color:var(--sidebar-bg); font-weight:700; }

.nav-fm {
  cursor:pointer; padding:5px 10px; border-radius:6px;
  font-size:0.85rem; color:var(--sidebar-text); transition:all 0.15s;
}
.nav-fm:hover { background:var(--sidebar-hover); }
.nav-fm.active { background:var(--sidebar-active); color:var(--gold-bright); }

.sidebar-overlay { display:none; position:fixed; inset:0; background:rgba(0,0,0,0.4); z-index:899; }
.sidebar-overlay.visible { display:block; }

/* ===== MAIN CONTENT ===== */
.main { padding-top:var(--header-h); min-height:100vh; }
.content { max-width:var(--content-max); margin:0 auto; padding:48px 28px 120px; }

[data-lang="dual"] .content { max-width:1200px; }

/* ===== FRONT MATTER ===== */
.fm-section { margin-bottom:48px; }
.fm-title {
  font-family:var(--font-display);
  font-size:1.6rem; font-weight:700; color:var(--gold);
  margin-bottom:16px; padding-bottom:8px;
  border-bottom:2px solid var(--border);
}
.fm-para { font-size:var(--fs-base); color:var(--ink-soft); margin-bottom:12px; text-align:justify; }

/* ===== TITLE PAGE ===== */
.title-page { text-align:center; padding:60px 0 40px; }
.title-page h1 {
  font-family:var(--font-display);
  font-size:3rem; font-weight:700; color:var(--gold);
  letter-spacing:0.04em; margin-bottom:8px;
}
.title-page .subtitle { font-size:1.3rem; color:var(--ink-faint); margin-bottom:32px; }
.title-page .translator { font-size:1rem; color:var(--ink-faint); }
.title-page .edition { font-size:0.9rem; color:var(--gold-light); margin-top:6px; }
.title-divider {
  width:80px; height:2px;
  background:linear-gradient(90deg,transparent,var(--gold),transparent);
  margin:24px auto;
}

/* ===== BOOK & CHAPTER ===== */
.book-header { text-align:center; padding:48px 0 32px; border-bottom:1px solid var(--border); margin-bottom:32px; }
.book-header h2 { font-family:var(--font-display); font-size:2.2rem; font-weight:700; color:var(--gold); letter-spacing:0.03em; }
.book-header-text { font-size:1rem; color:var(--ink-faint); margin-top:12px; line-height:1.8; text-align:justify; }

.chapter { margin-bottom:56px; }
.chapter-head { text-align:center; margin-bottom:24px; padding-bottom:16px; }
.chapter-number { font-family:var(--font-display); font-size:1.5rem; font-weight:700; color:var(--gold); }
.chapter-summary { font-size:0.95rem; color:var(--ink-faint); font-style:italic; margin-top:8px; line-height:1.75; text-align:justify; }

/* ===== VERSES — SINGLE MODE ===== */
.verse {
  padding:4px 8px; margin:0 -8px 4px; border-radius:4px;
  transition:background 0.15s; display:block;
}
.verse:hover { background:var(--verse-hover); }
.verse-num {
  font-family:var(--font-display);
  font-weight:700; font-size:0.8em; color:var(--gold);
  margin-left:4px; user-select:none;
}
.verse-text { font-size:var(--fs-base); color:var(--ink); }
.verse-text.empty { color:var(--ink-faint); font-style:italic; font-size:0.85em; }
.verses-block { text-align:justify; line-height:2.1; }

/* ===== VERSES — DUAL MODE ===== */
.verse-dual {
  display:grid; grid-template-columns:1fr 48px 1fr;
  gap:0; padding:6px 0; margin-bottom:4px;
  border-radius:6px; transition:background 0.15s;
  border-bottom:1px solid rgba(139,115,64,0.08);
  align-items:start;
}
.verse-dual:hover { background:var(--verse-hover); }
.verse-dual:last-child { border-bottom:none; }

.verse-heb {
  direction:rtl; text-align:justify;
  font-size:var(--fs-base); line-height:2.1;
  padding:0 12px 0 0;
  order:3;
}
.verse-eng {
  direction:ltr; text-align:justify;
  font-size:calc(var(--fs-base) * 0.9); line-height:1.85;
  color:var(--ink-soft);
  padding:0 0 0 12px;
  order:1;
}
.verse-center {
  display:flex; flex-direction:column; align-items:center;
  justify-content:flex-start; padding-top:4px;
  order:2; border-left:1px solid var(--border);
  border-right:1px solid var(--border);
  min-height:100%;
}
.verse-center .vnum-heb {
  font-family:var(--font-display); font-weight:700;
  font-size:0.85em; color:var(--gold); line-height:1.3;
}
.verse-center .vnum-eng {
  font-size:0.7em; color:var(--ink-faint); line-height:1.3;
}

/* ===== VERSES — INTERLINEAR MODE ===== */
[data-lang="inter"] .content { max-width:900px; }

.verse-inter {
  padding:12px 8px; margin-bottom:12px;
  border-bottom:1px solid rgba(139,115,64,0.1);
  direction:rtl; display:flex; flex-wrap:wrap;
  justify-content:flex-start; gap:4px 10px;
  line-height:1.4;
}
.verse-inter:last-child { border-bottom:none; }

.verse-inter .verse-num-inter {
  font-family:var(--font-display); font-weight:700;
  font-size:0.75em; color:var(--gold);
  align-self:flex-start; padding-top:2px;
  min-width:24px; text-align:center;
  user-select:none;
}

.inter-phrase {
  display:inline-flex; flex-direction:column;
  align-items:center; text-align:center;
  padding:2px 4px; border-radius:4px;
  transition:background 0.15s;
  vertical-align:top;
}
.inter-phrase:hover { background:var(--verse-hover); }

.inter-phrase .inter-heb {
  font-family:var(--font-display);
  font-size:var(--fs-base); font-weight:700;
  color:var(--ink); line-height:1.6;
  direction:rtl; white-space:nowrap;
}

.inter-phrase .inter-eng {
  font-family:var(--font-body);
  font-size:calc(var(--fs-base) * 0.6);
  color:var(--ink-faint); font-style:italic;
  line-height:1.35; direction:ltr;
  max-width:220px; white-space:normal;
  word-break:break-word;
}

/* ===== ENGLISH-ONLY MODE ===== */
[data-lang="en"] body { direction:ltr; }
[data-lang="en"] .sidebar { right:auto; left:0; transform:translateX(-100%); border-left:none; border-right:1px solid rgba(212,175,55,0.1); }
[data-lang="en"] .sidebar.open { transform:translateX(0); }

/* ===== CHAPTER NAV ===== */
.chapter-nav {
  display:flex; justify-content:space-between; align-items:center;
  padding:24px 0; border-top:1px solid var(--border); margin-top:32px;
}
.ch-nav-btn {
  background:none; border:1px solid var(--border);
  color:var(--gold); padding:8px 20px; border-radius:8px;
  cursor:pointer; font-family:var(--font-body);
  font-size:0.95rem; transition:all 0.2s;
}
.ch-nav-btn:hover { background:var(--gold); color:var(--parchment); border-color:var(--gold); }

/* ===== PROGRESS BAR ===== */
.progress-bar { position:fixed; top:var(--header-h); left:0; right:0; height:2px; background:var(--border); z-index:800; }
.progress-fill { height:100%; background:linear-gradient(90deg,var(--gold),var(--gold-bright)); width:0%; transition:width 0.1s; }

/* ===== SEARCH ===== */
.search-box { padding:12px 16px; border-bottom:1px solid rgba(212,175,55,0.1); }
.search-input {
  width:100%; background:rgba(212,175,55,0.08);
  border:1px solid rgba(212,175,55,0.15);
  color:var(--sidebar-text); padding:8px 12px;
  border-radius:8px; font-family:var(--font-body);
  font-size:0.9rem; outline:none; direction:rtl;
}
.search-input::placeholder { color:rgba(212,175,55,0.3); }
.search-input:focus { border-color:var(--gold); }

.search-results { max-height:300px; overflow-y:auto; padding:0 12px; }
.search-result {
  padding:8px; border-radius:6px; cursor:pointer;
  font-size:0.8rem; color:var(--sidebar-text);
  border-bottom:1px solid rgba(212,175,55,0.05);
}
.search-result:hover { background:var(--sidebar-hover); }
.search-result .sr-ref { color:var(--gold); font-weight:600; }
.search-result .sr-text { opacity:0.7; display:block; margin-top:2px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; }

/* ===== SCROLL TOP ===== */
.scroll-top {
  position:fixed; bottom:24px; left:24px;
  width:44px; height:44px; background:var(--gold);
  color:var(--parchment); border:none; border-radius:50%;
  cursor:pointer; font-size:1.2rem;
  display:none; align-items:center; justify-content:center;
  box-shadow:0 4px 16px var(--shadow); z-index:500; transition:all 0.2s;
}
.scroll-top.visible { display:flex; }
.scroll-top:hover { transform:scale(1.1); }

/* ===== LOADING ===== */
.loading { display:flex; align-items:center; justify-content:center; height:60vh; font-size:1.3rem; color:var(--gold); font-family:var(--font-display); }

/* ===== RESPONSIVE ===== */
@media (max-width:768px) {
  :root { --sidebar-w:280px; --fs-base:1.15rem; }
  .content { padding:32px 18px 100px; }
  .title-page h1 { font-size:2.2rem; }
  .book-header h2 { font-size:1.8rem; }
  .header-subtitle { display:none; }
  .verse-dual { grid-template-columns:1fr; gap:4px; }
  .verse-heb { order:1; padding:0; }
  .verse-center { order:0; flex-direction:row; gap:8px; border:none; padding:0 0 2px; min-height:auto; }
  .verse-eng { order:2; padding:0; }
  .inter-phrase .inter-eng { max-width:160px; }
}
@media (max-width:480px) {
  :root { --fs-base:1.05rem; }
  .content { padding:24px 14px 80px; }
  .font-controls { display:none; }
  .lang-btn { padding:5px 7px; font-size:0.7rem; }
}
